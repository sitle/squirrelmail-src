<!doctype linuxdoc system>
<!--
 Copyright (c) 2005 The SquirrelMail Project Team
 This file is part of SquirrelMail webmail interface documentation.

 SquirrelMail is free software; you can redistribute it and/or modify
 it under the terms of the GNU General Public License as published by
 the Free Software Foundation; either version 2 of the License, or
 (at your option) any later version.

 SquirrelMail is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 GNU General Public License for more details.

 You should have received a copy of the GNU General Public License
 along with SquirrelMail; if not, write to the Free Software
 Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
-->
<article>

<title>SquirrelMail Administrator's Manual
<author>
by the SquirrelMail Project Team:
<!-- put your name here -->
</author>
<date>$Date$
<abstract>
This document provides information about SquirrelMail webmail interface 
install procedures.
</abstract>

<toc>

<p>
Document version: $Revision$

<sect>SquirrelMail overview
<p>
SquirrelMail is a standards-based webmail package written in PHP4. It includes 
built-in pure PHP support for the IMAP and SMTP protocols, and all pages render
in pure HTML 4.0 (with no JavaScript required) for maximum compatibility across
browsers. It has very few requirements and is very easy to configure and 
install. SquirrelMail has all the functionality you would want from an email 
client, including strong MIME support, address books, and folder manipulation.

<sect1>SquirrelMail Requirements
<sect2>Requirements for running SquirrelMail:
<p>
<itemize>
  <item>UNIX/Linux or Windows (UNIX/Linux version may be more functional)
  <item>IMAP4rev1 server (e.g. uw-imap, courier-imap, cyrus-imap, hMailServer, 
    Binc IMAP, CommuniGate, MS Exchange Server, MercuryMail 32, Dovecot)
  <item>Web server with PHP4 installed (preferably <url
    url="http://httpd.apache.org/" name="Apache httpd">)
  <item>You need at least PHP 4.1.2. If you are using PHP 4.1.2 or 4.1.4, please 
    upgrade to the latest version ( >= 4.1.2.11, >= 4.1.4.1 final).
  <item>Perl installed on the system. (If you don't have Perl, SquirrelMail will 
    work fine but it's very helpful for the initial configuration. 
    Alternatively, you can manually edit the configuration files.)
  <item>Unlike many PHP applications, SquirrelMail does not require MySQL or
    other database type.
  <item>If you use MySQL for the address book or for prefs, note that Pear DB
    lib is required to be installed and available in the include
    path.
  <item>Aspell installed if using the SquirrelSpell plugin, For UNIX/Linux see:
    <url url="http://aspell.sourceforge.net/" name="http://aspell.sourceforge.net/">
    or for Windows, see: <url url="http://aspell.net/win32/" name="http://aspell.net/win32/">
  <item>Japanese language support: PHP must be compiled with the
    <tt/--enable-mbstring/ option for SquirrelMail to read and write Japanese
    emails. Each user must also set their language option to Japanese.
</itemize>

<sect2>Preferred configuration:
<p>
<itemize>
  <item>php with gettext and mbstring support. Without gettext you lose in
    performance. mbstring is actually required if you want a good i18n webmail
    system.
  <item>imap server that supports sort and thread imap extensions. Without these
    extensions you lose in performance.
  <item>imap server should support unicode. CourierIMAP must be compiled with
    <tt/--enable-unicode/ option. Without it some translations might be unable to use
    sorting and threading.
</itemize>

<sect2>Browser Requirements:
<p>
<itemize>
  <item>Cookies must be enabled in your browser.
</itemize>

<sect>Quick Start Guide
<p>
download it, configure it, use it.

<sect>Installing SquirrelMail
<sect1>Quick and Dirty install
<p>
QuickAndDirty

<sect1>Installing SquirrelMail on Unix and Linux systems
<p>
SquirrelMailInstallUnix

<sect1>Installing Squirrelmail on Windows systems with Apache webserver
<p>
SquirrelMailInstallWin32Apache

<sect1>Installing SquirrelMail on Windows systems with IIS webserver
<p>
SquirrelMailInstallIIS

<sect1>Installing SquirrelMail on MaxOS X systems
<p>
MacInfoHere

<sect1>Prepackaged SquirrelMail installs
<p>
SquirrelMail provides RPM.

<sect>Upgrading SquirrelMail
<p>
This chapter talks about upgrading existing SquirrelMail install.

<sect1>Backup old install
<p>
Make a backup of your current SquirrelMail directory.  If you use "cp", be
sure to use the "-Rp" options.  -R means recursive, and -p will save the
permissions in the directory.

In this example, we assume that your httpd document directory is 
<tt>/home/httpd/html</tt>, that your SquirrelMail install is located at
<tt>/home/httpd/html/squirrelmail-1.0.6</tt>, and that your new SM version is 1.2.0.
Substitute version numbers and names as required.

<verb>
$ cd /home/httpd/html
$ cp -Rp squirrelmail-1.0.6 squirrelmail-1.0.6.bak
</verb>

<sect1>Unarchive new SquirrelMail
<p>
Make sure that you are in your httpd document directory (<tt>/home/httpd/html</tt>)
and then unarchive the SquirrelMail archive (whatever the filename is): 
<verb>
$ tar -zxvf squirrelmail-1.2.0.tar.gz
</verb>

<sect1>Copy important files from old install
<p>
The important files to copy are:
<itemize>
  <item>Preferences
  <item>Config details
  <item>Plugins
  <item>Themes (if you've edited or added any of them)
</itemize>

<sect2>Preferences
<p>
First, copy your preference data over to the new directory.  Usually
this is ok, but if you are upgrading from anything less than 1.0.5, we
strongly suggest you let your users reset their preferences.  There
were important security upgrades in 1.0.5 regarding preference files.
<verb>
$ cp squirrelmail-1.0.6.bak/data/* squirrelmail-1.2.0/data
</verb>
  
<sect2>Config details
<p>
If at all possible, start the configuration process from scratch.  It is 
much less prone to missing configuration options than copying your old
configuration.  Ideally, you should just run conf.pl to reconfigure
SquirrelMail.  If you decide to copy your old config.php over, we strongly
recommend that you run conf.pl to make sure things are correct and then save
the config file.
<verb>
$ cp squirrelmail-1.0.6.bak/config/config.php squirrelmail-1.2.0/config
</verb>

<sect2>Copy plugins
<p>
Like SquirrelMail, plugins are frequently updated for improvements, as well
as to make them compatible with new SquirrelMail releases.  It is suggested
that you download new versions of your plugins at the same time you download
your SquirrelMail install, and that you install your plugins fresh (it's
easy, don't panic!).

You should not try replacing plugins that are already included in SquirrelMail
package. Download latest versions of plugins that are not included in new
SquirrelMail package or copy them from older SquirrelMail install.

<sect2>Copy themes
<p>
If you've created or modified themes, you should copy just those to the new
SquirrelMail themes directory.  To just copy them all over to the new
SquirrelMail installation, you can run one command.
<verb>
$ cp -ui squirrelmail-1.0.6.bak/themes/* squirrelmail-1.2.0/themes/
</verb>

When <tt/-u/ flag is used, command copies only missing and newer files. 
When <tt/-i/ flag is used, command will ask for confirmation before replacing
existing files.

If you want to see your theme in future SquirrelMail packages, send it to 
SquirrelMail developers. They might add it to the themes in the standard
install!

<sect1>Change permissions
<p>
The web server must have write permission to the data directory.  In this
example, we assume that user "nobody" and group "nobody" are the web server
as is often the case with Apache.
<verb>
  $ cd squirrelmail-1.2.0
  $ chown -R nobody:nobody data
</verb>
  
Check your webserver's configuration file. It might be using different
userid/groupid pair. Additionally, if "chown user:group" doesn't work, you can
use "chown user" and "chgrp group" instead. See the man pages for these commands
for more information.

If you are using SquirrelMail in setup with php safe_mode restrictions, data and
attachment directories should be owned by same user that owns other SquirrelMail
scripts. It must be writable by webserver group. Check <url
url="http://www.php.net/features.safe-mode" name="PHP Safe mode manual"> for
more details.

<sect1>Run conf.pl
<p>
Run config/conf.pl to see the new configuration options available with the
new version, as well as to verify that all of your old options are set
properly.

Always save your options, also if you haven't changed anything.
This will ensure that any problems with conf.pl that might have been solved
are effective to your installation.

If you want to make sure that your configuration contains all themes included in
new SquirrelMail package, go to theme options in configuration utility and 
run theme detection command.

<sect1>Version specific notes
<sect2>Upgrade from version older than 1.2.2 to later version.
<p>
In order to provide better internationalization support, developers have changed
names used by translations. From 1.2.2 SquirrelMail uses language and country
codes in translation names. In most of cases upgraded SquirrelMail should work
correctly. Only Norwegian Nynorsk (no_NO_ny) translation might need fixes. If
your user preference files contain <tt/language=no_NO_ny/ lines, these lines
should be updated to <tt/language=nn_NO/.

<sect2>Upgrade from 1.2.x or older versions to 1.4.x or later.
<p>
Layout changes. Plugins can break.

<sect2>Upgrade from version older than 1.4.4 to later version.
<p>
Translations are removed.

<sect2>Downgrade from 1.5.1 to older version.
<p>
Index Order options are not preserved.

<sect1>Recheck new install
<p>
Login into new SquirrelMail install and check if everything is working.

<sect1>Replace old install.
<p>
Redirect your users to new SquirrelMail install. You can use Apache <url 
url="http://httpd.apache.org/docs/mod/mod_alias.html#redirectperm"
name="RedirectPermanent"> directive or other redirection tools provided by your
webserver.

If you use SquirrelMail directory without version information, you can also
replace it with new SquirrelMail directory.
<verb>
$ mv /home/httpd/html/squirrelmail /home/httpd/html/squirrelmail.old
$ mv /home/httpd/html/squirrelmail.new /home/httpd/html/squirrelmail
</verb>

<sect1>DONE!
<p>
That should be all!  The most important part is copying your users'
preference files back into the new data directory.  This will insure that
your users will have their old preferences.  Remember to do so with caution,
especially if you are upgrading from a version before 1.0.5 to version 1.0.5
or later.

<sect>Configuring SquirrelMail
<p>
SquirrelMail stores interface configuration in <tt>config/config.php</tt>
file. This file can be controlled with SquirrelMail configuration utility
<tt>config/conf.pl</tt>. Default configuration values are stored and 
documented in <tt>config/config_default.php</tt> file.

<sect1>Basic configuration
<p>
In order to use SquirrelMail you must create configuration file. Default
configuration should adjusted to match your setup. Main things that should be
checked are:
<itemize>
  <item>Default domain (2. Server settings &gt; 1. Domain)
  <item>Addresses of IMAP and SMTP servers.
  <item>Type of IMAP server. See next chapter about <ref id="select-imap"
  name="selecting IMAP server">.
</itemize>

You might want to change:
<itemize>
  <item>Organization Preferences(1. Organization Preferences)
</itemize>

<sect1>Selecting IMAP server<label id="select-imap">
<p>
TODO: Recommend use of presets. List main presets. Explain why setting only
$imap_server_type does not work.

See chapter about <ref id="presets" name="Presets"> for more information about
server specific settings.

<sect1>Authentication
<p>
login, cram-md5, digest-md5.

<sect1>StartTLS, IMAPS, SSMTP
<p>
secure connection ways. supported and not supported. minimal requirements.

<sect1>Using database backends
<p>
SquirrelMail can store preferences and address books in database.

<sect1>Using more than one imap server
<p>
How to do that.

<sect1>Other configuration issues
<p>
Other configuration issues.

<sect>Optimizing SquirrelMail
<p>
What to do in order to make it fast without toasting the server.

<sect>Customizing SquirrelMail
<sect1>Plugins
<p>
SquirrelMail is modular system. Interface can be extented with extra features
provided by various plugins.

<sect1>Themes
<p>
Which color is da best.

<sect1>Site customizations
<p>
Own login page. Site control with vlogin plugin.

<sect1>Internationalization
<p>
Using interface with different languages.

<sect1>Personal and shared address books
<p>
Information about global address books here.

<sect>FAQ
<p>
Daily questions

<sect>Solving problems
<sect1>Common PHP error messages
<sect2>unknown function session_id() call
<p>
missing session support

<sect1>Common interface error messsages
<sect2>Unknown username or password
<p>
password is not ********. you need cookies.

<sect2>Session timeout
<p>
session.gc_maxlifetime

<sect2>Can't delete emails. Quota exceeded.
<p>
DisableTrash

<sect>Support
<p>
Where do I get support? How do I provide feedback, patches, feature 
suggestions, bug reports.

<sect1>SquirrelMail bugtracker
<p>
We have it on SF.

<sect1>SquirrelMail mailing lists
<p>
We have them too.

<sect1>Security contacts
<p>
address used for security contact.

<sect>Presets<label id="presets">
<p>
This chapter lists SquirrelMail options set by D option in SquirrelMail
configuration utility.

It can be used if user can't run configuration utility and changes options
manually. Settings can be different if IMAP server uses shared folders.

Possible server values are:
<itemize>
  <item>cyrus = Cyrus IMAP server
  <item>uw = University of Washington's IMAP server
  <item>exchange = Microsoft Exchange IMAP server
  <item>courier = Courier IMAP server
  <item>macosx = Mac OS X Mailserver
  <item>hmailserver = hMailServer
  <item>mercury32 = Mercury/32
  <item>dovecot = Dovecot Secure IMAP server
</itemize>

<sect1>default settings:
<p>
These are generic settings that should work in some IMAP servers.

<p>
<itemize>
  <item>imap_server_type = other
  <item>default_folder_prefix = none (is set to empty string)
  <item>trash_folder = INBOX.Trash
  <item>sent_folder = INBOX.Sent
  <item>draft_folder = INBOX.Drafts
  <item>show_prefix_option = false
  <item>default_sub_of_inbox = true
  <item>show_contain_subfolders_option = false
  <item>optional_delimiter = detect
  <item>delete_folder = false
  <item>force_username_lowercase = false
</itemize>

<sect1>'cyrus' preset
<p>
This preset is written for Cyrus IMAP.

<p>
<itemize>
  <item>imap_server_type = cyrus
  <item>default_folder_prefix = none (is set to empty string)
  <item>trash_folder = INBOX.Trash
  <item>sent_folder = INBOX.Sent
  <item>draft_folder = INBOX.Drafts
  <item>show_prefix_option = false
  <item>default_sub_of_inbox = true
  <item>show_contain_subfolders_option = false
  <item>optional_delimiter = .
  <item>delete_folder = true
  <item>force_username_lowercase = false
</itemize>

<sect1>'uw' preset
<p>
This preset is written for UW IMAPD.

<p>
<itemize>
  <item>imap_server_type = uw
  <item>default_folder_prefix = mail/
  <item>trash_folder = Trash
  <item>sent_folder = Sent
  <item>draft_folder = Drafts
  <item>show_prefix_option = true
  <item>default_sub_of_inbox = false
  <item>show_contain_subfolders_option = true
  <item>optional_delimiter = /
  <item>delete_folder = true
  <item>force_username_lowercase = true
</itemize>

Comments:
<itemize>
  <item>Since v.2002 UW IMAPD disabled plain text logins in default
  configuration. SquirrelMail can't use STARTTLS features provided by default
  server configuration. You might have to run IMAPS (IMAP over SSL) service or
  enable plain text logins.
</itemize>

<sect1>'exchange' preset
<p>
This preset is written for Microsoft Exchange IMAP server.

<p>
<itemize>
  <item>imap_server_type = exchange
  <item>default_folder_prefix = none (is set to empty string)
  <item>trash_folder = INBOX/Deleted Items
  <item>sent_folder = INBOX/Sent Items
  <item>draft_folder = Drafts
  <item>show_prefix_option = false
  <item>default_sub_of_inbox = true
  <item>show_contain_subfolders_option = false
  <item>optional_delimiter = detect
  <item>delete_folder = true
  <item>force_username_lowercase = true
</itemize>

<sect1>'courier' preset
<p>
This preset is written for Courier IMAP server.

<p>
<itemize>
  <item>imap_server_type = courier
  <item>default_folder_prefix = INBOX.
  <item>trash_folder = Trash
  <item>sent_folder = Sent
  <item>draft_folder = Drafts
  <item>show_prefix_option = false
  <item>default_sub_of_inbox = false
  <item>show_contain_subfolders_option = false
  <item>optional_delimiter = .
  <item>delete_folder = true
  <item>force_username_lowercase = false
</itemize>

<sect1>'macosx' preset
<p>
This preset is written for IMAP server used by MacOS X

<p>
<itemize>
  <item>imap_server_type = macosx
  <item>default_folder_prefix = INBOX/
  <item>trash_folder = Trash
  <item>sent_folder = Sent
  <item>draft_folder = Drafts
  <item>show_prefix_option = false
  <item>default_sub_of_inbox = true
  <item>show_contain_subfolders_option = false
  <item>optional_delimiter = detect
  <item>delete_folder = true
  <item>force_username_lowercase = false
</itemize>

<sect1>'hmailserver' preset
<p>
This preset is written for hMailServer

<p>
<itemize>
  <item>imap_server_type = hmailserver   (used in imap_search.php)
  <item>default_folder_prefix = none (is set to empty string)
  <item>trash_folder = INBOX.Trash
  <item>sent_folder = INBOX.Sent
  <item>draft_folder = INBOX.Drafts
  <item>show_prefix_option = false
  <item>default_sub_of_inbox = true
  <item>show_contain_subfolders_option = false
  <item>optional_delimiter = detect
  <item>delete_folder = false
  <item>force_username_lowercase = false
</itemize>

<sect1>'mercury32' preset
<p>
This preset is used for Mercury Mail Transport System. Preset is available since
SquirrelMail 1.5.0. It was tested on Mercury32 v.4.01b

<p>
<itemize>
  <item>imap_server_type = mercury32
  <item>default_folder_prefix = none (is set to empty string)
  <item>trash_folder = Trash
  <item>sent_folder = Sent
  <item>draft_folder = Drafts
  <item>show_prefix_option = false
  <item>default_sub_of_inbox = true
  <item>show_contain_subfolders_option = true
  <item>optional_delimiter = detect
  <item>delete_folder = true
  <item>force_username_lowercase = true
</itemize>

Comments:
<itemize>
  <item>Server side sorting and threading are not supported.
  <item>Message flags are not supported.
  <item>IMAP folders can store messages _or_ other folders.
  <item>Supports STARTTLS, if configured.
  <item>May have issues with 8bit IMAP folder names.
</itemize>

$imap_server_type variable is used to handle imap folder subscription
differences.

Site URL: <url url="http://www.pmail.com" name="http://www.pmail.com">

<sect1>'dovecot' preset
<p>
Preset used for Dovecot Secure IMAP server. It is available since SquirrelMail
1.5.1. There is no code specific to Dovecot IMAP server. Preset provides only a
quick way to set correct folder settings. Tested on Dovecot v.0.99.14

<p>
<itemize>
  <item>imap_server_type = dovecot
  <item>default_folder_prefix = none (is set to empty string)
  <item>trash_folder = Trash
  <item>sent_folder = Sent
  <item>draft_folder = Drafts
  <item>show_prefix_option = false
  <item>default_sub_of_inbox = false
  <item>show_contain_subfolders_option = false
  <item>optional_delimiter = detect
  <item>delete_folder = false
  <item>force_username_lowercase = true
</itemize>

Comments:
<itemize>
  <item>IMAP server supports server side sorting and threading.
</itemize>

Site URL: <url url="http://www.dovecot.org" name="http://www.dovecot.org">

</article>
